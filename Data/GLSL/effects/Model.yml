CustomEffects:
  ModelAttributes:
    Attributes:
      - { index: 0, name: ao_position, hint: "position", type: vec3 }
      - { index: 1, name: ao_normal, hint: "normal",   type: vec3, defines: "!SHADOW_PASS" }
      - { index: 2, name: ao_tangent, hint: "tangent",  type: vec3, default: [ 0.0, 1.0, 0.0 ], defines: "HAS_BUMP !SHADOW_PASS" }
      - { index: 10, name: ao_binormal, hint: "binormal", type: vec3, default: [ 0.0, 1.0, 0.0 ], defines: "HAS_BUMP !SHADOW_PASS"  }
      - { index: 3, name: ao_boneIndex,  hint: "blendindex", type: uvec4, default: [ 0, 0, 0, 0 ], defines: "HAS_SKELETON" }
      - { index: 4, name: ao_boneWeight,  hint: "blendweight", type: vec4, default: [ 1.0, 0, 0, 0 ], defines: "HAS_SKELETON"  }
      - { index: 5, name: ao_color, hint: "color", type: vec4, default: [ 1.0, 1.0, 1.0, 1.0 ], defines: "!SHADOW_PASS" }
      - { index: 6, name: ao_uv0, hint: "uv0", type: vec2, default: [0.0, 0.0], defines: "!SHADOW_PASS" }
      - { index: 7, name: ao_uv1, hint: "uv1", type: vec2, default: [0.0, 0.0], defines: "!SHADOW_PASS" }
      - { index: 8, name: ao_uv2, hint: "uv2", type: vec2, default: [0.0, 0.0], defines: "!SHADOW_PASS" }
      - { index: 9, name: ao_uv3, hint: "uv3", type: vec2, default: [0.0, 0.0], defines: "!SHADOW_PASS" }
      - { index: 11, name: ao_mModelMat, hint: "modelMat", type: mat3x4, defines: "INSTANCED"  }
    Samplers:
      - { index: 0, hint: "DiffuseColor", default: "Textures/white_default" }
      - { index: 1, hint: "NormalMap", default: "Textures/normal_default", defines: "!SHADOW_PASS" } # HAS_BUMP breaks when multiple in scene atm
      - { index: 2, hint: "EmissiveFactor", default: "Textures/black_default", defines: "!SHADOW_PASS"  }
      - { index: 3, hint: "SpecularColor", default: "Textures/black_default", defines: "!SHADOW_PASS"  }
      - { index: 4, hint: "Reflection",  type: "samplerCube", default: "Textures/white_cube", defines: "!SHADOW_PASS"  }      
    ConstantDefs:      
      - name: uVSMaterial
        binding: Material   
        shaderType: VS
        Variables:
         - { type: mat3x4,   name: mTexMatrix,    count: 4  }  # 0
         - { type: int,      name: iBoneCount,    count: 1, default: 0  }  # 0
         - { type: bool,     name: bBumpMap,      count: 1, default: false  }  # 0
         - { type: vec4,     name: clipPlane,      count: 1 }  # CLIP_PLANE
         - { type: bool,     name: bClipPlane,     count: 1, default: false }
      - name: uMaterial
        binding: Material1
        shaderType: PS
        defines: "!SHADOW_PASS"
        Variables:
          - { type: vec4,   name: emission,       count: 1, default: [0.0, 0.0, 0.0, 0.0] }  # 0
          - { type: vec4,   name: diffuse,        count: 1, default: [1.0, 1.0, 1.0, 1.0] }  # 16
          - { type: vec4,   name: specular,       count: 1, default: [1.0, 1.0, 1.0, 1.0] }  # 32
          - { type: float,  name: reflectionfactor, count: 1 } # 48
          - { type: float,  name: specularpow,    count: 1, default: 10.0 } # 52
          - { type: float,  name: alpha,          count: 1, default: 1.0 } # 56
          - { type: bool,   name: bDiffuseMap,    default: false } # 60
          - { type: bool,   name: bBumpMap,       default: false } # 64
          - { type: bool,   name: bSpecMap,       default: false } # 68
          - { type: bool,   name: bEmissiveMap,   default: false } # 72            
          - { type: bool,   name: bReflectionMap, default: false } # 76
          - { type: float,  name: alphaRef,       count: 1, default: 1.0 } # 80
          - { type: int,    name: alphaCmp,       count: 1, default: 0 } # 84 // Less, Equal, Greater
          - { type: vec4,  name: emissionMapMul, count: 1, default: [1.0, 1.0, 1.0, 1.0] } # 88
      - binding: Custom0
        shaderType: VS 
        defines: "!INSTANCED"        
        Variables:
         - { type: mat3x4,   name: mModelMat,    count: 1  }  # 0          
Effects: 
  - name: FBXDefault
    vert: models/fbxdefault
    frag: models/fbxdefault
    custom_effect: ModelAttributes
    define_sets:
      - name: deferred
        defines: DEFERRED_SHADING
      - name: depth
        defines: SHADOW_PASS
      - name: translucent
        defines: TRANSLUCENT_PASS
    global_sets:  # A variant of all the above with these sets will be automatically added
      # FIXME: Need automatic combinations as this is already bloating out of control
      - name: skel
        defines: HAS_SKELETON
      - name: skel.bump
        defines: HAS_SKELETON HAS_BUMP
      - name: skel.alphaTest
        defines: HAS_SKELETON ALPHA_TEST
      - name: skel.bump.alphaTest
        defines: HAS_SKELETON HAS_BUMP ALPHA_TEST
      - name: skel.clip
        defines: HAS_SKELETON CLIP_PLANE        
      - name: skel.bump.clip
        defines: HAS_SKELETON HAS_BUMP CLIP_PLANE
      - name: skel.alphaTest.clip
        defines: HAS_SKELETON ALPHA_TEST CLIP_PLANE
      - name: skel.bump.alphaTest.clip
        defines: HAS_SKELETON HAS_BUMP ALPHA_TEST CLIP_PLANE        

      - name: bump
        defines: HAS_BUMP
      - name: alphaTest
        defines: ALPHA_TEST        
      - name: bump.alphaTest
        defines: HAS_BUMP ALPHA_TEST        
      - name: clip
        defines: CLIP_PLANE        
      - name: bump.clip
        defines: HAS_BUMP CLIP_PLANE        
      - name: alphaTest.clip
        defines: ALPHA_TEST CLIP_PLANE       
      - name: bump.alphaTest.clip
        defines: HAS_BUMP ALPHA_TEST CLIP_PLANE

      - name: instance
        defines: INSTANCED
      - name: bump.instance
        defines: HAS_BUMP INSTANCED
      - name: alphaTest.instance
        defines: ALPHA_TEST INSTANCED     
      - name: bump.alphaTest.instance
        defines: HAS_BUMP ALPHA_TEST INSTANCED       
      - name: clip.instance 
        defines: CLIP_PLANE INSTANCED      
      - name: bump.clip.instance
        defines: HAS_BUMP CLIP_PLANE INSTANCED       
      - name: alphaTest.clip.instance
        defines: ALPHA_TEST CLIP_PLANE INSTANCED      
      - name: bump.alphaTest.clip.instance
        defines: HAS_BUMP ALPHA_TEST CLIP_PLANE INSTANCED

  - name: FBXDefault
    vert: models/fbxdefault
    geom: shadows/depthwriteomni
    frag: shadows/depthwriteomni
    custom_effect: ModelAttributes
    has_default: false
    define_sets:
      - name: omni_depth
        defines: SHADOW_PASS OMNI_DEPTH
    global_sets:  
      - name: skel
        defines: HAS_SKELETON              
      - name: skel.alphaTest
        defines: HAS_SKELETON ALPHA_TEST        
      - name: skel.clip
        defines: HAS_SKELETON CLIP_PLANE       
      - name: skel.alphaTest.clip
        defines: HAS_SKELETON ALPHA_TEST CLIP_PLANE          

      - name: alphaTest
        defines: ALPHA_TEST  
      - name: clip
        defines: CLIP_PLANE                
      - name: alphaTest.clip
        defines: ALPHA_TEST CLIP_PLANE 
      - name: instance
        defines: INSTANCED
      - name: alphaTest.instance
        defines: ALPHA_TEST INSTANCED
      - name: clip.instance
        defines: CLIP_PLANE INSTANCED       
      - name: alphaTest.clip.instance
        defines: ALPHA_TEST CLIP_PLANE INSTANCED
